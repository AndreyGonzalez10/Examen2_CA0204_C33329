---
title: "Examen 2 Herramientas de Ciencia de Datos I"
author: 
  - name: "Andrey González Bastos C33329"
  
date: "`r Sys.Date()`"  

format:
  html:
    self-contained: true
    toc: true
    toc_float: true
    df-print: paged
    theme: cosmo
    highlight: tango
---

#Punto 1

Cargar la base de datos y librerías

```{r, message=FALSE}
#Se cargan las librerías necesarias

library(readr)
library(readxl)
library(dplyr)
library(ggplot2)

#Se carga la base de datos corrigiendo las comas y eso de las columnas numéricas

moras <- read.csv("C:/Users/XPC/Desktop/Examen2_CA0204/data/moras.txt",
                  stringsAsFactors = FALSE,
                  header = TRUE)  

#Limpieza de comas y demás de la columna salario

moras$SALARIO <- gsub('"', '', moras$SALARIO)     
moras$SALARIO <- gsub("[^0-9,]", "", moras$SALARIO)
moras$SALARIO <- gsub(",", ".", moras$SALARIO)
moras$SALARIO <- as.numeric(moras$SALARIO)


```
#Punto 2

Resumen de los cinco números

```{r}

summary(moras$SALARIO)
summary(moras$EDAD)


```

#Punto 3

```{r, message=FALSE}

#Se crea una función para hacer ese cálculo más rápido para todas las entradas del vector 

z.scores.funcion <- function(vector){
  media = mean(vector, na.rm = TRUE)
  sd = sd(vector, na.rm = TRUE)
  z.score = (vector -media)/sd 
  return(z.score)

}

#Se le hacen las nuevas columnas al moras original  
moras <- moras %>% mutate(
z.score.salario = z.scores.funcion(moras$SALARIO),
z.score.edad = z.scores.funcion(moras$EDAD)
)

#Se comprueba que todo salió bien con un head

moras %>% head(5)


#Se hace la función para verificar rangos de z.score según la instrucción del 1.96

clasificadora.de.atipicos <- function(vector){
  resultado = ifelse(abs(vector)>1.96, "Atípico", "Normal")
  return(resultado)
}

#Se actualiza el dataframe

moras <- moras %>% mutate(
rango.z.salario = clasificadora.de.atipicos(z.score.salario),
rango.z.edad = clasificadora.de.atipicos(z.score.edad)
)

#Se hace un head pequeño para comprobar que todo salió bien

moras %>% head(5)

```

