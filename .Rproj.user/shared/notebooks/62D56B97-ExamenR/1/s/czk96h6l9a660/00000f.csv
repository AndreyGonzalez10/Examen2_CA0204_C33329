"0",""
"0","#Para esto igual hay que recurrir a un for"
"0",""
"0","graficar.morosos <- function(df, indicador = ""INDICADOR_MOROSO"") {"
"0","  "
"0","  categoricas <- names(df)[sapply(df, function(x) is.character(x) || is.factor(x))]"
"0","  "
"0","  for (var in categoricas) {"
"0","    resumen <- df %>%"
"0","      group_by(.data[[var]]) %>%"
"0","      summarise("
"0","        total = n(),"
"0","        morosos = sum(.data[[indicador]] == 1, na.rm = TRUE),"
"0","        porcentaje_morosos = (morosos / total) * 100,"
"0","        .groups = ""drop"""
"0","      ) %>%"
"0","      arrange(desc(porcentaje_morosos))"
"0","    "
"0","    print(resumen)  # muestra tabla resumen"
"0","    "
"0","    # Gráfico de barras con porcentaje de morosos"
"0","    p <- ggplot(resumen, aes(x = reorder(.data[[var]], -porcentaje_morosos),"
"0","                             y = porcentaje_morosos,"
"0","                             fill = .data[[var]])) +"
"0","      geom_bar(stat = ""identity"") +"
"0","      labs(title = paste(""Porcentaje de morosos por"", var),"
"0","           x = var,"
"0","           y = ""% Morosos"") +"
"0","      theme_minimal() +"
"0","      theme(axis.text.x = element_text(angle = 45, hjust = 1),"
"0","            legend.position = ""none"")"
"0","    "
"0","    print(p)  # muestra gráfico"
"0","  }"
"0","}"
"0",""
"0","graficar.morosos(moras)"
